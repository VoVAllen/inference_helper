# 问题定义
我们将执行一个消息传递的单层GNN模块称为消息传递模块。其余普通的计算操作（例如relu, add）称为计算节点，属于在GPU计算过程中产生的中间结果，消息传递模块是特殊的计算节点。每个计算节点会有输入和输出。此外，计算图中还存在资源节点，资源节点表示的是存在CPU上的数据。资源节点指向计算节点代表将该数据从CPU转移到GPU上；计算节点指向资源节点代表将该中间结果从GPU转移到CPU上；计算节点a指向计算节点b表示a节点的输出是b节点的输入，为GPU内的数据传输。每一条边都有一个权重，代表该数据转移的数据量。

我们通过分析forward的计算图，依照节点之间的依赖关系，我们可以得到一张计算依赖图，该图为有向无环图。该图的输入输出为资源节点，其余节点均为计算节点。

我们可以对计算图中的计算节点连接做以下操作：改造一条边，使起始计算节点与终止计算节点之间的数据传输需要途径一次CPU。这样的操作在计算图中的表示为：将一条计算节点指向计算节点的边移除。假设这两个点分别为A和B，查看A是否有连向一个资源节点的边，若没有，则创建一个资源节点C，将A指向C相连，C节点的开销设为A的输出量。如果已经存在A连向的资源节点，无需创建。然后将C节点指向B，使C节点的开销加上C节点的输出量。资源节点的开销意义为其输入和输出的数据量之和。

目标：在计算图中改造若干条边，使得任意两个消息传递模块之间的路径上有且只有一个资源节点（路径上经过其他消息传递模块的不算，此处的路径为不经过其他消息传递模块的路径），并且使新创的资源节点的开销之和最小。此操作的实际意义为，两个消息传递模块之间，一定会经过一次将数据放回到CPU中，再从CPU读回GPU的操作，并且使GPU与CPU之间数据转移量最小。
