import sklearn
import matplotlib.pyplot as plt

def modf(result, xst, xed):
    num_batch, max_i, max_o, max_e, tot_i = [], [], [], [], []
    for i in range(len(result[0])):
        if result[0][i] >= xst and result[0][i] <= xed:
            num_batch.append(result[0][i])
            max_i.append(result[1][i])
            max_o.append(result[2][i])
            max_e.append(result[3][i])
            tot_i.append(result[4][i])
    return num_batch, max_i, max_o, max_e, tot_i

def draw(result, result2, name, xst=200, xed=1000):
    num_batch1, max_i1, max_o1, max_e1, tot_i1 = modf(result, xst, xed)
    num_batch2, max_i2, max_o2, max_e2, tot_i2 = modf(result2, xst, xed)

    plt.scatter(num_batch1, tot_i1, color='red')
    plt.plot(num_batch1, tot_i1, color='red')

    plt.scatter(num_batch2, tot_i2, color='blue')
    plt.plot(num_batch2, tot_i2, color='blue')

    # plt.yscale("log")
    # plt.xscale("log")
    # plt.scatter(X, y)
    # plt.plot(X, y)
    plt.xlabel("number of batch")
    plt.ylabel("total input nodes count")
    plt.title(name)
    # plt.ylim(0, 4000000)
    plt.xlim(xst, xed)

    plt.show()
    plt.savefig("fig/" + name + "-total-input")
    plt.clf()


# suffle=True, reddit
default_suffle = [[20, 40, 60, 80, 100, 120, 140, 160, 181, 201, 221, 241, 261, 280, 301, 321, 341, 361, 381, 401, 421, 441, 461, 481, 500, 521, 541, 560, 582, 602, 622, 642, 662, 682, 701, 721, 742, 764, 783, 804, 821, 844, 862, 882, 903, 925, 942, 965, 984], [204957, 188466, 176270, 165752, 158740, 150994, 144671, 139229, 133752, 129197, 124888, 121924, 117226, 116089, 111643, 110649, 105953, 105591, 101898, 98124, 96512, 97105, 93044, 93163, 89064, 87613, 89303, 86904, 81556, 84917, 81631, 81743, 80475, 83731, 80558, 77606, 73956, 77026, 74572, 74125, 71623, 71352, 69339, 68302, 66966, 68612, 65556, 67558, 64403], [7675, 3837, 2558, 1918, 1535, 1279, 1096, 959, 852, 767, 697, 639, 590, 548, 511, 479, 451, 426, 403, 383, 365, 348, 333, 319, 307, 295, 284, 274, 264, 255, 247, 239, 232, 225, 219, 213, 207, 201, 196, 191, 187, 182, 178, 174, 170, 166, 163, 159, 156], [3935366, 1970069, 1383398, 1016344, 845428, 690307, 628009, 549523, 473210, 458250, 426048, 381723, 347205, 360665, 309044, 284205, 290452, 265673, 244792, 245551, 229125, 221461, 213824, 214591, 186946, 193553, 201751, 174964, 165710, 175321, 169902, 169798, 159640, 158348, 175186, 150888, 142440, 141872, 136088, 134220, 126570, 132986, 131026, 130681, 128132, 123088, 123564, 121453, 130140], [4075514, 7472284, 10431522, 13059896, 15427357, 17577015, 19523131, 21349033, 23034870, 24561688, 26034005, 27396115, 28664335, 29859037, 30995937, 32074391, 33015854, 34000433, 34983715, 35792383, 36597952, 37415285, 38158073, 38915045, 39560385, 40228053, 40864527, 41467534, 42149340, 42643327, 43237765, 43774543, 44265918, 44756809, 45183402, 45602959, 46102474, 46620689, 47088660, 47451341, 47819163, 48226937, 48545855, 48959708, 49264885, 49646834, 50001366, 50311704, 50556922]]
custom_suffle = [[22, 44, 66, 87, 109, 131, 152, 174, 196, 218, 240, 261, 283, 305, 327, 349, 371, 392, 414, 436, 458, 480, 502, 524, 546, 568, 589, 612, 634, 656, 677, 700, 722, 744, 766, 788, 810, 832, 854, 876, 898, 921, 942, 964, 987, 1010, 1032, 1054, 1076], [203050, 185824, 173507, 162615, 154452, 146465, 139802, 134143, 129538, 124165, 118396, 116184, 111448, 108565, 105096, 100996, 98178, 95497, 92608, 91670, 88930, 86517, 86180, 81597, 80378, 79023, 77017, 75736, 74072, 72910, 70832, 69668, 68649, 66678, 66279, 64945, 64430, 62585, 61128, 61427, 60553, 59404, 57803, 57147, 56225, 55191, 54155, 53178, 52668], [7335, 3777, 2565, 1984, 1546, 1328, 1133, 1008, 894, 841, 766, 699, 648, 610, 562, 519, 507, 481, 468, 445, 412, 398, 406, 365, 360, 364, 348, 333, 326, 298, 301, 294, 290, 268, 274, 259, 282, 267, 248, 234, 238, 232, 234, 236, 227, 215, 209, 218, 207], [3499949, 1749997, 1166665, 874998, 699995, 583332, 499996, 437498, 388885, 349995, 318180, 291664, 269228, 249997, 233332, 218746, 205878, 194443, 184206, 174999, 166665, 159088, 152172, 145831, 139999, 134614, 129627, 124999, 120688, 116665, 112902, 109374, 106059, 102940, 99999, 97221, 94593, 92104, 89742, 87499, 85364, 83332, 81394, 79544, 77776, 76085, 74467, 72914, 71427], [4436262, 8079521, 11174991, 13910478, 16411346, 18650821, 20628677, 22534637, 24250426, 25848590, 27347005, 28697800, 30031831, 31258931, 32410217, 33488857, 34483056, 35448865, 36415488, 37284934, 38185532, 38903110, 39676194, 40390589, 41147712, 41746761, 42431318, 43077833, 43607325, 44192406, 44751090, 45294441, 45769333, 46288315, 46789380, 47293350, 47686775, 48134658, 48518767, 49002869, 49382206, 49770515, 50150930, 50519074, 50888539, 51152339, 51521795, 51796838, 52117467]]

draw(default_suffle, custom_suffle, "reddit-shuffle")

# shuffle=False
default = [[20, 40, 60, 80, 100, 120, 140, 160, 181, 201, 221, 241, 261, 280, 301, 321, 341, 361, 381, 401, 421, 441, 461, 481, 500, 521, 541, 560, 582, 602, 622, 642, 662, 682, 701, 721, 742, 764, 783, 804, 821, 844, 862, 882, 903, 925, 942, 965, 984], [208166, 199750, 193479, 191477, 182614, 183496, 184062, 172563, 177973, 173918, 167926, 174943, 163298, 171254, 169448, 161215, 166636, 158534, 163282, 158829, 155172, 158834, 156714, 157804, 149861, 148517, 153323, 147020, 149063, 145012, 143468, 150115, 149059, 150699, 142640, 141736, 146042, 143758, 144829, 145903, 142064, 143140, 135591, 141872, 139090, 134029, 138723, 132630, 131843], [7675, 3837, 2558, 1918, 1535, 1279, 1096, 959, 852, 767, 697, 639, 590, 548, 511, 479, 451, 426, 403, 383, 365, 348, 333, 319, 307, 295, 284, 274, 264, 255, 247, 239, 232, 225, 219, 213, 207, 201, 196, 191, 187, 182, 178, 174, 170, 166, 163, 159, 156], [11622632, 8426007, 5730133, 6577773, 5364842, 4692075, 5300492, 3540271, 3915777, 4303117, 2890034, 3672929, 2955361, 3229739, 3349996, 2740690, 2835430, 2661337, 2987024, 2203140, 2373464, 2559261, 2122721, 2402700, 1886040, 1760547, 2106602, 1740381, 1843240, 1619448, 1614803, 1998905, 1920707, 2098354, 1613424, 1594901, 1860655, 1660089, 1719056, 1803099, 1569250, 1625044, 1279432, 1544643, 1561529, 1249906, 1547433, 1271353, 1224359], [2981909, 5007983, 6567320, 7855245, 8932680, 9798850, 10623063, 11346720, 11893976, 12531520, 13087301, 13495838, 13982030, 14355296, 14731846, 15095750, 15455164, 15747641, 16024880, 16264677, 16588390, 16860162, 17120165, 17344820, 17501021, 17712289, 17963117, 18186024, 18363621, 18576198, 18715611, 18917300, 19093599, 19194336, 19366825, 19510295, 19650334, 19895501, 20025966, 20170910, 20269495, 20367203, 20559587, 20668012, 20755875, 20877345, 20954523, 21082120, 21195333]]
custom = [[22, 44, 66, 87, 109, 131, 152, 174, 196, 218, 240, 261, 283, 305, 327, 349, 371, 392, 414, 436, 458, 480, 502, 524, 546, 568, 590, 612, 634, 656, 678, 700, 722, 744, 766, 788, 810, 832, 855, 877, 898, 921, 943, 965, 987, 1010, 1032, 1054, 1076], [187120, 168935, 147755, 139585, 126107, 120406, 116154, 109461, 102718, 101743, 94341, 93496, 88919, 82737, 85665, 76540, 80211, 73183, 71346, 71493, 68015, 69981, 62441, 63500, 63175, 61861, 61316, 60165, 57640, 56035, 58525, 54460, 51799, 53311, 53222, 52729, 49068, 51503, 48467, 50239, 48749, 46337, 47905, 46913, 46721, 45862, 45862, 45768, 43522], [33215, 20205, 15309, 12873, 11084, 9713, 8938, 8457, 8180, 7866, 7655, 7506, 7293, 7096, 6879, 6472, 5950, 5770, 5633, 5525, 5433, 5342, 5218, 5116, 5052, 4928, 4875, 4840, 4816, 4798, 4783, 4771, 4761, 4753, 4704, 4553, 4371, 4351, 4328, 4211, 4150, 4043, 3961, 3921, 3819, 3763, 3731, 3719, 3680], [3499983, 1749999, 1166662, 874989, 699998, 583328, 499998, 437499, 388887, 349999, 318178, 291661, 269229, 249999, 233332, 218746, 205881, 194442, 184209, 174999, 166665, 159086, 152172, 145832, 139999, 134614, 129627, 124998, 120688, 116663, 112902, 109374, 106059, 102940, 99999, 97221, 94593, 92104, 89742, 87497, 85364, 83332, 81394, 79544, 77776, 76085, 74466, 72915, 71427], [3721547, 6194064, 8044027, 9516026, 10761326, 11814580, 12737560, 13559910, 14372883, 15012626, 15608008, 16141746, 16705891, 17175025, 17670396, 18120480, 18472857, 18930094, 19293793, 19610983, 19946802, 20216070, 20525281, 20889669, 21129120, 21374281, 21610894, 21947428, 22171483, 22413061, 22693758, 22840783, 23092383, 23306028, 23558831, 23731965, 24002725, 24262019, 24399158, 24548500, 24815591, 24981186, 25189679, 25252216, 25492226, 25586839, 25813108, 25945625, 26130770]]
draw(default, custom, "reddit-non-shuffle")
